# Webster+ Object  
  
**Methods**|   
---|---  
  
Below is a list of Webster+ methods in alphabetical order. When referencing the method, it would normally be prefixed with **%Webster'**.

**Method** |  **Description**  
---|---  
**AddRow**(_gridname_ _$, row_) |  This function can be used to add a row to a grid. It will use the current values for the variables defined in the IOList attached to the grid memory file as defined in the variable names in _gridname_ _$_. If the specified row already exists in the grid, a new row will be inserted. An Error 11 will occur when an invalid row is specified. _(The AddRow method was added in PxPlus 2022.)_  
**ChgRow**(_gridname_ _$_ , _row_) |  This function can be used to update an existing row in a grid. It will use the current values for the variables defined in the IOList attached to the grid memory file as defined in the variable names in _gridname_ _$_. If the specified row does not exist in the grid, an Error 11 will occur. _(The ChgRow method was added in PxPlus 2022.)_  
**ClrUserField**(_variable$_) |  This function is used to clear/remove the specified user variable from the current user's profile.  
**Console.Error( )** **Console.Log( )** **Console.Warn( )** |  These functions provide a means to output to the browser log. **%Webster'Console._xxx_**(_text$_) **_Where:_** |  _xxx_ |  Identifies the type of console output. Value options are _Log_ , _Warn_ and _Error_.  
---|---  
_text$_ |  Contains the text to display on the browser console.  
  
The console output can be viewed by the user by pressing F12 on most browsers. The three types of output are displayed in different colors based on the severity with _Error_ generally being on a Red background, _Warn_ on a Yellow background and _Log_ being on White.  
  
**DelRow**(_gridname_ _$_ , _row_) |  This function can be used to delete an existing row in a grid. If the specified row does not exist in the grid, an Error 11 will occur. _(The DelRow method was added in PxPlus 2022.)_  
**Download**(_filename$_) |  This function initiates a file download to the workstation. **_Where:_** |  _filename$_ |  Contains the pathname of the file you want sent to the workstation.  
---|---  
  
This function will initiate a browser download of the specified file. The file will be placed in the standard download location based on the workstation or device settings.  
  
**Enable**(_id$, state_) |  This function can be used to enable/disable a button on the page. **_Where:_** |  _id$_ |  Contains the ID of the button as specified on the targeted **[[button]](Short%20Codes.htm#button)** short code using **id=**_xxx_.  
---|---  
_state_ |  If non-zero, will enable the button; zero will disable it.  
**Event**(_eventname_ _$_) |  This function is used to force an event to be generated by a Webster+ page.  **_Where:_** |  _eventname_ _$_ |  Name of the event you want the Webster+ page to submit after being updated.  
---|---  
  
#### **Note:**  
This function switches Webster+ from a full screen refresh to an Ajax style update.  
  
**Focus**(_element$_[ ,_grid$_ , _line_ ] [_,__radiobtnval_ _$_] ) |  This function is used to set focus to the specified element on the page. |  _element$_ |  A string that contains the name of the element (variable name) on the Webster+ generated page that focus will be sent to.  
---|---  
_grid$_ |  Optional parameter that contains the grid name when selecting a field in a grid.  
_line_ |  Optional parameter that contains the line number when selecting a field in a grid.  
_radiobtnval_ _$_ |  Optional parameter used when the target element is a radio button. This parameter should contain the value of the radio button desired.  
  
#### **Note:**  
When setting focus to a tree view, you **_must_** use the associated string variable name, not the numeric variable name defined in the short code.  
  
**_Example:_**  
  
For [tree MyTree], you would use %Webster'Focus("MyTree$").  
  
**GetFileUrl$**(_filename$_) |  This function returns a URL that can be used to retrieve any file on the system from a browser. This function is typically used to provide access to images or other files (PDF, Documents, etc.). The URL returned includes an encrypted key that Webster+ will use to access the file. The key is based on the user currently signed on; thus, the URL itself is only of use to that user. **_Where:_** |  _filename$_ |  Contains the pathname to the file for which you want to get a URL.  
---|---  
  
#### **Note:**  
The URL returned can **_only_** be used within Webster+. It cannot be used in an email or other such communication as it will **_only_** work from a browser session on which the current user is signed on.  
  
**GetiNomadsEmbedURL$**(_URLToEmbed_ _$_) |  This function returns a URL that will display the given iNomads URL embedded in a Webster+ page. **_Where:_** |  _URLToEmbed_ _$_ |  iNomads URL to display embedded in Webster+.  
---|---  
  
_(The GetiNomadsEmbedURL$ method was added in PxPlus 2024.)_  
  
**GetTempFile$**(_filename$_) |  This function returns the pathname to a temporary file based on the filename provided. These temporary files should be deleted when no longer needed; however, the system will delete any temporary file over one day old. **_Where:_** |  _filename$_ |  Contains a desired filename upon which the temporary filename will be derived.  
---|---  
  
The path returned will point to a file in the system temporary file directory (as defined in Webster+ setup) with the filename provided altered to include a unique timestamp sequence number inserted before the file suffix.  
  
**Hide**(_name$, state_[_,__leavespace_]) |  This function can be used to hide/show a control on the page. **_Where:_** |  _id$_ |  Contains the name or ID of the control targeted.  
---|---  
_state_ |  If non-zero, will hide the control; zero will show it.  
_leavespace_ |  **_(Optional)_** If non-zero and the control is hidden, the space on the screen occupied by the control will remain. If zero (or omitted), the page layout will be adjusted to appear as the control has been removed.  
**Lock**(_name$, state_) |  This function can be used to lock a control such as an input field or list. **_Where:_** |  _name$_ |  Contains the name or ID of the variable associated with the control to be locked.  
---|---  
_state_ |  If non-zero, will lock the control; zero will unlock it.  
**Message**(_messageid_ _$_**WITH** _variable$=value$, variable=value_) |  This function will return the message identified by _messageid_ _$_ from the system message library. **_Where:_** |  _messageid_ _$_ |  Contains the key of the message stored in the system message library.  
---|---  
_variable$_ |  Contains the name of a variable that will appear in the message and is to be replaced.  
_value$_ |  Value that replaces the variable.  
  
This method provides enhanced replacement capabilities over the standard **[MSG( )](../functions/msg.md)** function; however, instead of replacing parameters by ordinal numbers (%1, %2, %3, etc.), it replaces values by variable name.

**_Example:_**

Using **[Message Library Maintenance](Message%20Library%20Maintenance.md)**, the following message could be defined:

_Message Key:_ OnHold  
_Message Text:_ The client %Acct$ is on hold.

You could then use this method to convert this, passing the message key and the values to be substituted as follows:

Text$ = %Webster'Message$("OnHold" with Acct$=AccountNo$)

This would replace the string %Acct$ with the value currently in AccountNo$.

Numeric variables can also be used; however, no formatting of the value will be done; that is, the parameter in the text will be replaced with a simple STR( ) of the variable's value.

#### **Note:**  
The **%Acct$** in the sample message text above should not be confused with a global variable. The leading **%** simply identifies the variable to be replaced and is designed to be consistent with the numbered parameters %1, $2, %3, etc.  
  
**MsgBox**(_message$_ , _title$_ , _options$_ [ , _eventprefix_ _$_ ] ) |  This function provides the ability to generate and display a message box on the page when it is returned to the browser. The buttons on the message box can be used to signal events to your page for further processing. **_Where:_** |  _message$_ |  Contains the message text you want to display on the browser. You can use SEP or $0A$ (LF) to separate lines of text and $09$ (TAB) to insert four spaces.  
---|---  
_title$_ |  Contains the title to be displayed on the top of the message box.  
_options$_ |  Used to define the icon and buttons in the message box. See PxPlus **[MSGBOX](../directives/msgbox.md)** directive for valid options.  
_eventprefix_ _$_ |  Optional prefix to be applied to the events associated with the buttons in the message box. If omitted, the default of "msgbox" will be applied.

#### **Note:**  
The suffix and the event will be separated by an _ (_underscore_).  
  
When the user selects a button from the message box, Webster+ will generate an event, causing the page contents and event to be returned to the program specified on the **[[form]](Short%20Codes.htm#form)** short code.

The event name will be lowercase text value from the button. For example, the "Yes" button by default will return an event of "msgbox_yes". The "OK" button (when no _eventprefix_ _$_ is defined) and the "Cancel" button (in all cases) are exceptions and will simply close the message box without generating an event.

Optionally, if you manually define button text using **BTN1** =_xxx_ , etc., you can include a **:Event** following the text to appear on the button, and that will be used instead. For example, if you included the option "**BTN1=Authorize:auth** ", the first button would contain the text "Authorize" and, when pressed, would generate an "**auth** " event.

**_Example:_**

Suppose you want a message box to ask for confirmation to delete a record. This could be done using the following:

> **%Webster'MsgBox("Do you want to delete this record","Please confirm","?,YESNO","delete")**

This would display a message box and, if the user clicked the "Yes" button, your program would receive an event of "**delete_yes** ". If the user selects "No", you will receive "**delete_no** ". If the user simply closes the message box, you will receive nothing.

If you do not want or need a "**delete_no** " event, you can add "**btn2=No:** " to the option string. This will override the default behavior for the "No" button and simply cause the message box to close with no event generated.  
  
**OptionBox**(_boxname_ _$_ , _msg_ _$_ , _event$_ , _opt1$_ , _opt2$_ , ,_opt5$_) |  This method can be used to update a named infobox (a **[[show]](Short%20Codes.htm#show)** short code with the class of **[infobox](Webster%20Defined%20Classes.htm#additional)**) with message text followed by up to five options from which the user can select. **_Where:_** |  _boxname_ _$_ |  Name of the infobox on the page. Must be the name of a string variable.  
---|---  
_msg_ _$_ |  Message text to display in the message box.  
_event$_ |  Name of an event to trigger once any option is selected. Must be the name of a valid numeric variable, or if null (""), the _boxname_ (less the trailing $) will be used.  
_opt1$_ through _opt5$_ |  Options to be displayed to the user (two to five options are supported).  
  
Once the user selects one of the options, the specified event will be generated with the corresponding variable (same as event name) loaded with the number of the option selected.

**_Example:_**

%webster'OptionBox("payinfo$","iNo outstanding invoices to pay",  
"",  
"I don't care",  
"Really I don't",  
"I'm not kidding")  
---  
  
would generate an infobox like this:

Since the _event$_ parameter specified is "", once the user selects one of the options, the event "payinfo" (name of the infobox) will be generated, and the variable "payinfo" will be set to the selected option number.

_(The OptionBox method was added in PxPlus 2022.)_  
  
**PopInput**(_message$_ , _title$_ , _options$_ , _variable$_ [ , _inputoptions_ _$_ ] ) |  This function provides an enhanced MsgBox that will prompt for input. The value entered by the user will be returned in a variable named by the _variable$_ parameter. **_Where:_** |  _message$_ |  Contains the message text you want to display on the browser. You can use SEP or $0A$ (LF) to separate lines of text and $09$ (TAB) to insert four spaces.  
---|---  
_title$_ |  Contains the title to be displayed on the top of the message box.  
_options$_ |  Used to define the icon and buttons in the message box. See PxPlus **[MSGBOX](../directives/msgbox.md)** directive for valid options.  
_variable$_ |  A string whose value defines the name of the string variable to receive the response entered by the user; e.g. "response$".  
_inputoptions_ _$_ |  Optional string that contains **[input]** short code options. Only the following options are allowed: **[align](Short%20Code%20Options.htm#align)**, **[class](Short%20Code%20Options.htm#class)**, **[format](Short%20Code%20Options.htm#format)**, **[len](Short%20Code%20Options.htm#len)**, **[size](Short%20Code%20Options.htm#size)** (_width_ only), **[tip](Short%20Code%20Options.htm#tip)** and **[uppercase](Short%20Code%20Options.htm#uppercase)**. Multiple options are separated by a space.  
  
_(The PopInput method was added in PxPlus 2022.)_  
  
**SetErrorMsg**( [ _variable$_ , _message$_ [ ,_grid$_ , _line_ ] ] ) |  This function is used to force an input field to be flagged as invalid and to set the error message to be displayed. **_Where:_** |  _variable$_ |  A string that contains the name of the variable on the Webster+ generated page that is to be marked invalid.  
---|---  
_message$_ |  Contains the error message to be displayed.  
_grid$_ |  Optional parameter that contains the grid name if specifying a field in a grid.  
_line_ |  Optional parameter that contains the line number if specifying a field in a grid.  
  
Once an error has been set on a field, you must either replace the whole page or specify an empty ("") error message. If there are **_any_** fields with errors, a button with a 'validate' specification will not issue its associated event when pressed. Instead, the system will set focus on the first invalid field on the screen and redisplay its associated error message.  
  
**SetUserField**(_variable$, value$_) |  This function is used to define user variables that will be loaded into %usr._variable_ _$_ and made accessible to the application. **_Where:_** |  _variable$_ |  Name of the string variable that will be prefixed with "%usr." whose value will be saved and loaded.  
---|---  
_value$_ |  Contains the value that will be saved and loaded.  
  
This routine will allow values to be saved to the profile information for the current user.

**_Example:_**

%Webster'SetUserField("CellPhone","4165551212")

This would result in the value %usr.CellPhone$ being set to "4165551212" on subsequent requests for the current user.

A maximum of 2K worth of data values may be saved.  
  
**ShowFile**(_pathname$_[,_newtab_]) |  This function is used to show a file, such as an image file or PDF, to the user (if _newtab_ =**1** , force new tab).  
**SignalChange**(_pathname$_) |  This function signals a change in the specified _pathname$_ that can be watched (using the **[WatchChange](Webster%20Object%20Methods.htm#watchchange)** method) by another tab in the browser. It is used by the Webster+ program and HTML page editors to signal that a file has changed in order to have other tabs, such as a directory listing or program view, update their display. _(The SignalChange method was added in PxPlus 2021 Update 1.)_  
**Update**(_channelNumber_) |  This function is used to update the contents of a tree view by passing the channel number that contains the tree view contents. When updated (like when initially displayed), the tree view will only show the top level of the tree. To expand/expose lower levels, you need to update the tree view using the **%Webster'Update**(_tree_name_ _$_ , _value$_) method. The **%Webster'Update**(_channelNumber_) method can also be used to directly update the contents of a grid. _(The Update(channelNumber) method was added in PxPlus 2023.)_  
**Update**(_listboxname_ _$_) |  This function is used to update a list box. It is a more consistent way of running **%Webster'Bind'Reload**(_listboxname_ _$_). See **[%Webster'Bind'Reload](Bind%20Object%20Methods.htm#reload)**. **_Where:_** |  _listboxname_ _$_ |  Contains the name of the list box.  
---|---  
  
_(The Update(listboxname$) method was added in PxPlus 2023.)_  
  
**Update**( [ _variable$_ , _value$_ [ ,_grid$_ , _line_ ] ] ) |  This function is used to update the contents of a variable on a Webster+ generated HTML page. **_Where:_** |  _variable$_ |  A string that contains the name of the variable on the Webster+ generated page that is to be updated with the value specified.  
---|---  
_value$_ |  Contains the new value the field is to contain.  
_grid$_ |  Optional parameter that contains the grid name when updating a field in a grid.  
_line_ |  Optional parameter that contains the line number when updating a field in a grid.  
  
You can call this routine with no parameters to force Webster+ to flip to Ajax style updates.

This can be useful if you have nothing to update on the screen (i.e. you only processed the event and do not change anything).

It can also be used in conjunction with **%Webster'SetErrorMsg**("_control_ ", "_message_ ") to set a validation error message on a control or if all you want to do is respond with a message box using the method **%Webster'MsgBox**("_message_ ", "_title_ ", "_options_ ").

If you do not call **'Update( )** to flip to Ajax mode, your response will be sent as part of a full screen retransmission.  
  
**UpdateFMDisplay( )** |  This function is used in conjunction with **[File Maintenance](../NOMADS%20Graphical%20Application/Dictionary-Based%20Development/Fmgen/Fmgen%20Introduction.md)** generated Webster+ pages to force a full update of **_all_** fields on the page as if a new record has been retrieved.

#### **Note:**  
This function switches Webster+ from a full screen refresh to an Ajax style update.  
  
**UpdateFMShowVars( )** |  This function is used in conjunction with File Maintenance generated Webster+ pages to force an update of any **SHOW**._xxxx_ values on the current page. For information on **SHOW**._xxxx_ descriptive fields, see **[Extended Class Validation and Display](../Data%20Dictionary/Data%20Classes/Extended%20Validation.md)**.

#### **Note:**  
This function switches Webster+ from a full screen refresh to an Ajax style update.  
  
**UpdateIOL**(_iolist_ _$_ , _values$_ [ ,_grid$_ , _line_ ] ) |  This function is used to update the contents of multiple variables on a Webster+ generated HTML page. **_Where:_** |  _iolist_ _$_ |  Contains an IOList of the variables to be updated.  
---|---  
_values$_ |  Contains the new values for the fields identified in the _iolist_ _$_. This string will be parsed using the _iolist_ _$_ provided to extract the individual field values.  
_grid$_ |  Optional parameter that contains the grid name when updating fields in a grid.  
_line_ |  Optional parameter that contains the line number when updating fields in a grid.  
  
#### **Note:**  
This function switches Webster+ from a full screen refresh to an Ajax style update.  
  
**WatchChange**(_pathname$ buttonid$_) |  This function initiates a background monitor for changes made by another tab in the same browser to the specified _pathname$_. When a change is signaled (using the **[SignalChange](Webster%20Object%20Methods.htm#signalchange)** method), the button whose ID is specified in _buttonid_ _$_ will be logically clicked, allowing an event to be sent to the host for processing. To monitor a directory for any changes in subordinate files, append **/*** to the directory name. _(The WatchChange method was added in PxPlus 2021 Update 1.)_  
  
## See Also

**[Properties](Webster%20Object%20Properties.md)**
