# How To Tutorials

**How to Customize the PxPlus Progress Bar**|   
---|---  
  
Starting with PxPlus 2025, the Progress Bar interface has been updated to give it a more modern look and feel. The appearance of the progress bar can also be further customized by using the five **[Global Variables](../utilities/progbars.htm#Mark1)**, which have been provided to control the different aspects of the progress bar. These variables may be set in the START_UP program or in any other program prior to initializing a progress bar.

The examples below show you how to set these five global variables. Each example provides two screenshots showing the default appearance on the left and the customized appearance on the right.

Use these links to access a particular example:

**[How to Change the Progress Bar Color](How%20to%20Customize%20Progress%20Bar.htm#Mark1)**

**[How to Change the Background Color of the Progress Bar Window](How%20to%20Customize%20Progress%20Bar.htm#Mark2)**

**[How to Change the Font for the Text](How%20to%20Customize%20Progress%20Bar.htm#Mark3)**

**[How to Change the Color of the Percent Indicator Text](How%20to%20Customize%20Progress%20Bar.htm#Mark4)**

**[How to Change the Text Color](How%20to%20Customize%20Progress%20Bar.htm#Mark5)**

For the steps to set up the PxPlus progress bar, see **[How to Set Up the PxPlus Progress Bar](How%20to%20Customize%20Progress%20Bar.htm#Mark6)**.

#### **Note:**  
Any of the colors being set by these global variables can be one of the standard PxPlus colors, an RGB color, a User-Defined color or an HTML Hex color.  
  
If you want to have different progress bars in different applications, simply set these variables prior to initializing the progress bar.

## How to Change the Progress Bar Color (%_PROGBAR_BAR_CLR)

The color of the progress bar meter can be controlled by setting the **%_PROGBAR_BAR_CLR$** global variable.

**_Example:_**

%_progbar_bar_clr$="RGB:155 0 0" (Burgundy)

## How to Change the Background Color of the Progress Bar Window (%_PROGBAR_BACK_CLR$)

The background color of the progress bar window can be controlled by setting the **%_PROGBAR_BACK_CLR$** global variable.

**_Example:_**

%_progbar_back_clr$="Dark Gray"

## How to Change the Font for the Text (%_PROGBAR_FONT$)

The font used for **_both_** the text (passed in as the _text$_ parameter) **_and_** the text on the _Cancel_ button can be controlled by setting the **%_PROGBAR_FONT$** global variable.

**_Example:_**

%_progbar_font$="Algerian"

## How to Change the Color of the Percent Indicator Text (%_PROGBAR_PERCENT_CLR$)

When using the **CALL "*progbar;Update_percent"** method, the color of the percent indicator (passed in as the _percent_ parameter) can be controlled by setting the **%_PROGBAR_PERCENT_CLR$** global variable.

## How to Change the Text Color (%_PROGBAR_TEXT_CLR$)

The color of the text (passed in as the _text$_ parameter) can be controlled by setting the **%_PROGBAR_TEXT_CLR$** global variable.

## How to Set Up the PxPlus Progress Bar

The three steps below show you how to set up the three **CALL** routines that are required in a program to invoke the PxPlus progress bar.

These steps consist of initializing the progress bar, updating the progress bar, and then removing the progress bar window.

**_1\. Initializing the Progress Bar_**

The first step is to place this **CALL** just before running the process or report in your program:

**CALL "*progbar;Init"** , _title$_ , _barsize_ , [ , _column_ , _row_ , _options$_ , _ctlno_ ]

**_Where:_**

_title$_ |  **_(Required)_** A string that contains the title, which will display at the top of the progress bar window. **_Example:_**  
---|---  
_barsize_ |  **_(Optional)_** A numeric value that contains the width of the bar to be created in columns. Minimum bar size is 15. **_Example:_** barsize=40  
_column, row_ |  **_(Optional)_** Numeric values that contain the coordinates where the window will display on the screen. **_Example:_** column=150, row=10 (top right corner)  
_options$_ |  **_(Optional)_** A string that contains the attribute options to be used in the creation of the dialogue window. Typical use would be to make the dialogue windows concurrent, thereby allowing the user to access controls on the current window. This would be the **OPT=**_string$_ settings for the dialogue window. See **['DIALOGUE'](../mnemonics/dialogue.md)** mnemonic for a list of supported options. **_Example:_** options$="i,-"  
  
**i** Window has no icon in the upper left corner.  
**-** _(dash/minus sign)_ Window has a Minimize button.  
_ctlno_ |  **_(Optional)_** A control value used to override the default control value of 4 that will be generated by the _Cancel_ button. Users can cancel the process by doing one of the following:

  * Pressing the **F4** key (CTL=4 is used to close most panels)
  * Pressing the **ESC** key
  * Clicking the **Cancel** button
  * Clicking the **X** (Close) button

When any of these methods are used, the following message displays: **_How to Remove the Cancel Button_** You may decide that you do not want the user to cancel the process because the program needs to finish properly; e.g. the program could be in a routine where files are being updated. You can remove the _Cancel_ button so that the program finishes correctly with no interruptions. |  1. |  In any progress bar program, add a flag during initialization, which will remove the _Cancel_ button from the progress bar window: %_no_progbar_cancel=1;call "*progbar;init", _title$_ , _barsize_ , _column_ , _row_ , _options$_ , _ctlno_  
---|---  
2. |  During the wrapup, set another flag to **%_NO_PROGBAR_CANCEL=0** to turn it Off: %_no_progbar_cancel=0;call "*progbar;wrap_up"  
  
**_2\. Updating the Progress Bar_**

The second step is to update the progress bar. This **CALL** will go into the loop where the screen is loading or the records are being accumulated for the report being generated.

Two display types for the progress bar are available to choose from: _Advance Bar_ or _Show % Complete_.

  * **_Advance Bar:_**  _(Default)_ Shows the progress advancing from left to right and resets back to the left edge when the bar maximum is reached.



> **CALL "*progbar;Update"** [, ERR=_stmtref_], _text$_ [ , _image$_ ]

  * **_Show % Complete:_** Shows the percentage complete as a portion of the bar. If you know how much time is needed or how many records are being processed, it is a good idea to show the percentage as the program is running.



> **CALL "*progbar;Update_percent"** [, ERR=_stmtref_], _text$_ , _percent_ , [ , _image$_ ]

**_Where:_**

**ERR=**_stmtref_ |  **_(Optional)_** An error transfer to a specific line number or statement label in which to transfer control. **_Example:_**  
---|---  
_text$_ |  **_(Required)_** A string that contains the text to be displayed in the progress bar window. **_Example:_** Alternatively, you can create text with multiple lines by entering a carriage return/line feed ($0D0A$) after each line to improve readability. **_Example:_** **__**  
_image$_ |  **_(Optional)_** A string that contains the pathname to an image that will be displayed in the top/left corner of the progress bar window. **_Example:_** To add a single image (e.g. an hourglass), the following syntax can be used: image$="C:\\.myImage\hourglass48x48.png" **_How to Animate an Image (Optional)_** You can make an image appear animated by using the **[MOD( )](../functions/mod.md)** function and two images. The **MOD( )** function returns the modulus/remainder from a division of the first expression by the second. **_Example:_** |  1. |  Add a counter after the record is ready.  
  
recs++  
---|---  
2. |  Using the **MOD( )** function, if the remainder is not 0, the image will show the Widgets; otherwise, it will show the Update image.  
  
if recs|2<>0 then image$="!32X32/Buttons/Widgets" else image$="!32X32/Buttons/Update"  
3. |  Add a **[WAIT](../directives/wait.md)** directive to pause for a second to allow the image to be updated on the screen.  
  
wait 1  
_percent_ |  **_(Required)_** The _percent_ parameter is used only in the **Show % Complete** method as a numeric value that contains the percentage of the bar to show as complete. **CALL "*progbar;Update_percent"** [, ERR=_stmtref_], _text$_ , _percent_ , [ , _image$_ ] **_Example:_** **_How to Calculate the "percent" Parameter_** These steps show you how to calculate the _percent_ parameter: |  1. |  Use the **[FIN( )](../functions/fin.md)** function to get the number of records in the file.  
  
rec=num(fin(filno_chn,"RECORDS_USED"))  
---|---  
2. |  Set a counter within the loop where it is updating.  
  
recs++  
3. |  Take the **rec** counter value, divide by the total records in the file and multiply by 100 to get the percent.  
  
percent=(recs/rec)*100  
  
**_3\. Closing the Progress Bar_**

The third step is to remove the progress bar window. When the accumulation is complete, you can add a method for the entry point to remove the progress bar window.

**CALL "*progbar;Wrap_up"**

## See Also

**[*PROGBAR Progress Bar Display](../utilities/progbars.md)**
